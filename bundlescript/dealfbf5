var tpd=function(n){function i(i,r){var u,w,b,l,c,a;try{tpc.waitToggle();var f=tpc.getGUID(),v=tpc.getGUID(),p="",s="",e="",o="",h=new Date,y=0;for(r.DSC.filter(n=>n["@Key"]==="FLEXIDATE")[0]["@Value"]==="true"?(e=h.setDate(h.getDate()+Number(r.DSC.filter(n=>n["@Key"]==="FROMDATE")[0]["@Value"])),h=new Date,o=h.setDate(h.getDate()+Number(r.DSC.filter(n=>n["@Key"]==="TODATE")[0]["@Value"])),y=(new Date(o).getTime()-new Date(e).getTime())/n.oneDay,e=tpc.formatDate(e),o=tpc.formatDate(o)):(e=r.DSC.filter(n=>n["@Key"]==="FROMDATE")[0]["@Value"],o=r.DSC.filter(n=>n["@Key"]==="TODATE")[0]["@Value"],u=e.split("-"),w=new Date(u[0],Number(u[1])-1,u[2]),u=o.split("-"),b=new Date(u[0],Number(u[1])-1,u[2]),y=(new Date(b).getTime()-new Date(w).getTime())/n.oneDay),r.DSC.filter(n=>n["@Key"]==="HOTELNAME").length>0&&(p=r.DSC.filter(n=>n["@Key"]==="HOTELNAME")[0]["@Value"]),$.ajax({type:"GET",async:!1,url:"/static/hotelcities?q="+r.DSC.filter(n=>n["@Key"]==="CITY")[0]["@Value"],success:function(n){s=n.Items[0].Item},error:function(){}}),tpc.htlRequestObject.Rooms.Room=[],tpc.htlRequestObject.Stay.Nationality=tpc.companySettings.nationality,tpc.htlRequestObject.Stay.CityName=s.split("~")[1].split("#")[0],tpc.htlRequestObject.Stay.CountryName=s.split("~")[1].split("#")[1],tpc.htlRequestObject.Stay.CityCode=s.split("~")[1].split("#")[2],tpc.htlRequestObject.Stay.CountryCode=s.split("~")[1].split("#")[3],tpc.htlRequestObject.Stay.CheckIn=e,tpc.htlRequestObject.Stay.CheckOut=o,tpc.htlRequestObject.Stay.Nights=y,tpc.htlRequestObject.Filters.HotelName=p,l=0;l<Number(r.DSC.filter(n=>n["@Key"]==="ROOMS")[0]["@Value"]);l++)c=r.DSC.filter(n=>n["@Key"]==="ROOM"+(l+1))[0]["@Value"],a={Occupancy:{NoAdults:c.split("~")[0],NoChildren:c.split("~")[1]}},Number(a.Occupancy.NoChildren)>0&&(a.Occupancy.ChildAges={ChildAge:[c.split("~")[2],c.split("~")[3]]}),tpc.htlRequestObject.Rooms.Room.push(a);$.ajax({type:"POST",url:"/hotel/search?searchid="+f,data:JSON.stringify({Root:tpc.htlRequestObject}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){tpc.htlRequestObject.Filters.TwoStep==="Y"?t(i,"/hotel/availabilitycheck?searchid="+f+"&reviewId="+v+"&rid="):t(i,"/hoteldeal/"+r["@URL"]+"?searchid="+f)},failure:function(){tpc.htlRequestObject.Filters.TwoStep==="Y"?t(i,"/hotel/availabilitycheck?searchid="+f+"&reviewId="+v+"&rid="):t(i,"/hoteldeal/"+r["@URL"]+"?searchid="+f)},error:function(){tpc.htlRequestObject.Filters.TwoStep==="Y"?t(i,"/hotel/availabilitycheck?searchid="+f+"&reviewId="+v+"&rid="):t(i,"/hoteldeal/"+r["@URL"]+"?searchid="+f)}})}catch(k){console.log(k.stack)}}function r(n,i){var r;try{tpc.waitToggle();var o="",s="",e=tpc.getGUID();$.ajax({type:"GET",async:!1,url:"/static/airports?q="+i.DSC.filter(n=>n["@Key"]==="ORIGIN")[0]["@Value"],success:function(n){o=n.Items[0].Item},error:function(){}});$.ajax({type:"GET",async:!1,url:"/static/airports?q="+i.DSC.filter(n=>n["@Key"]==="DESTINATION")[0]["@Value"],success:function(n){s=n.Items[0].Item},error:function(){}});tpc.airRequestObject.Flights.CabinCode=i.DSC.filter(n=>n["@Key"]==="CLASS")[0]["@Value"];tpc.airRequestObject.Flights.TripType=i.DSC.filter(n=>n["@Key"]==="TRIPTYPE")[0]["@Value"];tpc.airRequestObject.Flights.JourneyType="INT";tpc.airRequestObject.Passengers.Passenger[0].Count=i.DSC.filter(n=>n["@Key"]==="ADT")[0]["@Value"];tpc.airRequestObject.Passengers.Passenger[1].Count=i.DSC.filter(n=>n["@Key"]==="CHD")[0]["@Value"];tpc.airRequestObject.Passengers.Passenger[2].Count=i.DSC.filter(n=>n["@Key"]==="INF")[0]["@Value"];tpc.airRequestObject.Flights.RequestedSegment=[];var u=new Date,f="",l=o.split("~")[0],h=o.split("~")[1],a=h.split("#")[1],v=s.split("~")[0],c=s.split("~")[1],y=c.split("#")[1];i.DSC.filter(n=>n["@Key"]==="FLEXIDATE")[0]["@Value"]==="true"?(f=u.setDate(u.getDate()+Number(i.DSC.filter(n=>n["@Key"]==="FROMDATE")[0]["@Value"])),f=tpc.formatDate(f)):f=i.DSC.filter(n=>n["@Key"]==="FROMDATE")[0]["@Value"];tpc.airRequestObject.Flights.RequestedSegment.push(new tpc.RequestedSegment(l,v,a,y,f,"",h,c));tpc.airRequestObject.Flights.TripType==="RT"&&(u=new Date,r="",i.DSC.filter(n=>n["@Key"]==="FLEXIDATE")[0]["@Value"]==="true"?(r=u.setDate(u.getDate()+Number(i.DSC.filter(n=>n["@Key"]==="TODATE")[0]["@Value"])),r=tpc.formatDate(r)):r=i.DSC.filter(n=>n["@Key"]==="TODATE")[0]["@Value"],tpc.airRequestObject.Flights.RequestedSegment.push(new tpc.RequestedSegment(v,l,y,a,r,"",c,h)));$.ajax({type:"POST",url:"/flight/search?searchid="+e,data:JSON.stringify({Root:tpc.airRequestObject}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){t(n,"/flightdeal/"+i["@URL"]+"?searchid="+e)},failure:function(){t(n,"/flightdeal/"+i["@URL"]+"?searchid="+e)},error:function(){t(n,"/flightdeal/"+i["@URL"]+"?searchid="+e)}})}catch(p){console.log(p.stack)}}function t(n,t){$(n).attr("target")!==undefined&&$(n).attr("target")==="_blank"?window.open(t,"_blank"):window.location.href=t}function u(i,r){var u,w,b,l,c,a;try{tpc.waitToggle();var f=tpc.getGUID(),v=tpc.getGUID(),p="",s="",e="",o="",h=new Date,y=0;for(r.DealCriteria.Criteria.filter(n=>n.Key==="FLEXIDATE")[0].Value==="true"?(e=h.setDate(h.getDate()+Number(r.DealCriteria.Criteria.filter(n=>n.Key==="FROMDATE")[0].Value)),h=new Date,o=h.setDate(h.getDate()+Number(r.DealCriteria.Criteria.filter(n=>n.Key==="TODATE")[0].Value)),y=(new Date(o).getTime()-new Date(e).getTime())/n.oneDay,e=tpc.formatDate(e),o=tpc.formatDate(o)):(e=r.DealCriteria.Criteria.filter(n=>n.Key==="FROMDATE")[0].Value,o=r.DealCriteria.Criteria.filter(n=>n.Key==="TODATE")[0].Value,u=e.split("-"),w=new Date(u[0],Number(u[1])-1,u[2]),u=o.split("-"),b=new Date(u[0],Number(u[1])-1,u[2]),y=(new Date(b).getTime()-new Date(w).getTime())/n.oneDay),r.DealCriteria.Criteria.filter(n=>n.Key==="HOTELNAME").length>0&&(p=r.DealCriteria.Criteria.filter(n=>n.Key==="HOTELNAME")[0].Value),$.ajax({type:"GET",async:!1,url:"/static/hotelcities?q="+r.DealCriteria.Criteria.filter(n=>n.Key==="CITY")[0].Value,success:function(n){s=n.Items[0].Item},error:function(){}}),tpc.htlRequestObject.Rooms.Room=[],tpc.htlRequestObject.Stay.Nationality=tpc.companySettings.nationality,tpc.htlRequestObject.Stay.CityName=s.split("~")[1].split("#")[0],tpc.htlRequestObject.Stay.CountryName=s.split("~")[1].split("#")[1],tpc.htlRequestObject.Stay.CityCode=s.split("~")[1].split("#")[2],tpc.htlRequestObject.Stay.CountryCode=s.split("~")[1].split("#")[3],tpc.htlRequestObject.Stay.CheckIn=e,tpc.htlRequestObject.Stay.CheckOut=o,tpc.htlRequestObject.Stay.Nights=y,tpc.htlRequestObject.Filters.HotelName=p,l=0;l<Number(r.DealCriteria.Criteria.filter(n=>n.Key==="ROOMS")[0].Value);l++)c=r.DealCriteria.Criteria.filter(n=>n.Key==="ROOM"+(l+1))[0].Value,a={Occupancy:{NoAdults:c.split("~")[0],NoChildren:c.split("~")[1]}},Number(a.Occupancy.NoChildren)>0&&(a.Occupancy.ChildAges={ChildAge:[c.split("~")[2],c.split("~")[3]]}),tpc.htlRequestObject.Rooms.Room.push(a);$.ajax({type:"POST",url:"/hotel/search?searchid="+f,data:JSON.stringify({Root:tpc.htlRequestObject}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){tpc.htlRequestObject.Filters.TwoStep==="Y"?t(i,"/hotel/availabilitycheck?searchid="+f+"&reviewId="+v+"&rid="):t(i,"/hoteldeal/"+r.URL+"?searchid="+f)},failure:function(){tpc.htlRequestObject.Filters.TwoStep==="Y"?t(i,"/hotel/availabilitycheck?searchid="+f+"&reviewId="+v+"&rid="):t(i,"/hoteldeal/"+r.URL+"?searchid="+f)},error:function(){tpc.htlRequestObject.Filters.TwoStep==="Y"?t(i,"/hotel/availabilitycheck?searchid="+f+"&reviewId="+v+"&rid="):t(i,"/hoteldeal/"+r.URL+"?searchid="+f)}})}catch(k){console.log(k.stack)}}function f(n,i){var r;try{tpc.waitToggle();var o="",s="",e=tpc.getGUID();$.ajax({type:"GET",async:!1,url:"/static/airports?q="+i.DealCriteria.Criteria.filter(n=>n.Key==="ORIGIN")[0].Value,success:function(n){o=n.Items[0].Item},error:function(){}});$.ajax({type:"GET",async:!1,url:"/static/airports?q="+i.DealCriteria.Criteria.filter(n=>n.Key==="DESTINATION")[0].Value,success:function(n){s=n.Items[0].Item},error:function(){}});tpc.airRequestObject.Flights.CabinCode=i.DealCriteria.Criteria.filter(n=>n.Key==="CLASS")[0].Value;tpc.airRequestObject.Flights.TripType=i.DealCriteria.Criteria.filter(n=>n.Key==="TRIPTYPE")[0].Value;tpc.airRequestObject.Flights.JourneyType="INT";tpc.airRequestObject.Passengers.Passenger[0].Count=i.DealCriteria.Criteria.filter(n=>n.Key==="ADT")[0].Value;tpc.airRequestObject.Passengers.Passenger[1].Count=i.DealCriteria.Criteria.filter(n=>n.Key==="CHD")[0].Value;tpc.airRequestObject.Passengers.Passenger[2].Count=i.DealCriteria.Criteria.filter(n=>n.Key==="INF")[0].Value;tpc.airRequestObject.Flights.RequestedSegment=[];var u=new Date,f="",l=o.split("~")[0],h=o.split("~")[1],a=h.split("#")[1],v=s.split("~")[0],c=s.split("~")[1],y=c.split("#")[1];i.DealCriteria.Criteria.filter(n=>n.Key==="FLEXIDATE")[0].Value==="true"?(f=u.setDate(u.getDate()+Number(i.DealCriteria.Criteria.filter(n=>n.Key==="FROMDATE")[0].Value)),f=tpc.formatDate(f)):f=i.DealCriteria.Criteria.filter(n=>n.Key==="FROMDATE")[0].Value;tpc.airRequestObject.Flights.RequestedSegment.push(new tpc.RequestedSegment(l,v,a,y,f,"",h,c));tpc.airRequestObject.Flights.TripType==="RT"&&(u=new Date,r="",i.DealCriteria.Criteria.filter(n=>n.Key==="FLEXIDATE")[0].Value==="true"?(r=u.setDate(u.getDate()+Number(i.DealCriteria.Criteria.filter(n=>n.Key==="TODATE")[0].Value)),r=tpc.formatDate(r)):r=i.DealCriteria.Criteria.filter(n=>n.Key==="TODATE")[0].Value,tpc.airRequestObject.Flights.RequestedSegment.push(new tpc.RequestedSegment(v,l,y,a,r,"",c,h)));$.ajax({type:"POST",url:"/flight/search?searchid="+e,data:JSON.stringify({Root:tpc.airRequestObject}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){t(n,"/flightdeal/"+i.URL+"?searchid="+e)},failure:function(){t(n,"/flightdeal/"+i.URL+"?searchid="+e)},error:function(){t(n,"/flightdeal/"+i.URL+"?searchid="+e)}})}catch(p){console.log(p.stack)}}return n.oneDay=864e5,n.dealList={},n.callAction=function(n){try{var f=$(n).attr("data-tp-deal-id"),e=tpd.dealList.Response.Deal.DC instanceof Array?tpd.dealList.Response.Deal.DC:[tpd.dealList.Response.Deal.DC],u=e.filter(n=>n["@Id"]===f)[0];u["@SearchCriteria"]==="Y"?u["@Product"]==="AIR"?r(n,u):u["@Product"]==="HTL"&&i(n,u):t(n,"/deal/"+u["@URL"])}catch(o){return console.log(o.stacktrace),!1}},n.dealCallAction=function(n){try{var r=$(n).attr("data-tp-deal-id"),i=tpd.dealList.Response.DealList.Deal.filter(n=>n.Id===r)[0];i.SearchCriteria==="Y"?i.Product==="AIR"?f(n,i):i.Product==="HTL"&&u(n,i):t(n,"/deal/"+i.URL)}catch(e){return console.log(e.stacktrace),!1}},n}(tpd||{}),tpcd=function(n){function i(i,r){var u,w,b,l,c,a;try{tpc.waitToggle();var f=tpc.getGUID(),v=tpc.getGUID(),p="",s="",e="",o="",h=new Date,y=0;for(r.DealCriteria.Criteria.filter(function(n){return n.Key==="FLEXIDATE"})[0].Value==="true"?(e=h.setDate(h.getDate()+Number(r.DealCriteria.Criteria.filter(function(n){return n.Key==="FROMDATE"})[0].Value)),h=new Date,o=h.setDate(h.getDate()+Number(r.DealCriteria.Criteria.filter(function(n){return n.Key==="TODATE"})[0].Value)),y=(new Date(o).getTime()-new Date(e).getTime())/n.oneDay,e=tpc.formatDate(e),o=tpc.formatDate(o)):(e=r.DealCriteria.Criteria.filter(function(n){return n.Key==="FROMDATE"})[0].Value,o=r.DealCriteria.Criteria.filter(function(n){return n.Key==="TODATE"})[0].Value,u=e.split("-"),w=new Date(u[0],Number(u[1])-1,u[2]),u=o.split("-"),b=new Date(u[0],Number(u[1])-1,u[2]),y=(new Date(b).getTime()-new Date(w).getTime())/n.oneDay),r.DealCriteria.Criteria.filter(function(n){return n.Key==="HOTELNAME"}).length>0&&(p=r.DealCriteria.Criteria.filter(function(n){return n.Key==="HOTELNAME"})[0].Value),$.ajax({type:"GET",async:!1,url:"/static/hotelcities?q="+r.DealCriteria.Criteria.filter(function(n){return n.Key==="CITY"})[0].Value,success:function(n){s=n.Items[0].Item},error:function(){}}),tpc.htlRequestObject.Rooms.Room=[],tpc.htlRequestObject.Stay.Nationality=tpc.companySettings.nationality,tpc.htlRequestObject.Stay.CityName=s.split("~")[1].split("#")[0],tpc.htlRequestObject.Stay.CountryName=s.split("~")[1].split("#")[1],tpc.htlRequestObject.Stay.CityCode=s.split("~")[1].split("#")[2],tpc.htlRequestObject.Stay.CountryCode=s.split("~")[1].split("#")[3],tpc.htlRequestObject.Stay.CheckIn=e,tpc.htlRequestObject.Stay.CheckOut=o,tpc.htlRequestObject.Stay.Nights=y,tpc.htlRequestObject.Filters.HotelName=p,l=0;l<Number(r.DealCriteria.Criteria.filter(function(n){return n.Key==="ROOMS"})[0].Value);l++)c=r.DealCriteria.Criteria.filter(function(n){return n.Key==="ROOM"+(l+1)})[0].Value,a={Occupancy:{NoAdults:c.split("~")[0],NoChildren:c.split("~")[1]}},Number(a.Occupancy.NoChildren)>0&&(a.Occupancy.ChildAges={ChildAge:[c.split("~")[2],c.split("~")[3]]}),tpc.htlRequestObject.Rooms.Room.push(a);$.ajax({type:"POST",url:"/hotel/search?searchid="+f,data:JSON.stringify({Root:tpc.htlRequestObject}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){tpc.htlRequestObject.Filters.TwoStep==="Y"?t(i,"/hotel/availabilitycheck?searchid="+f+"&reviewId="+v+"&rid="):t(i,"/hoteldeal/"+r.URL+"?searchid="+f)},failure:function(){tpc.htlRequestObject.Filters.TwoStep==="Y"?t(i,"/hotel/availabilitycheck?searchid="+f+"&reviewId="+v+"&rid="):t(i,"/hoteldeal/"+r.URL+"?searchid="+f)},error:function(){tpc.htlRequestObject.Filters.TwoStep==="Y"?t(i,"/hotel/availabilitycheck?searchid="+f+"&reviewId="+v+"&rid="):t(i,"/hoteldeal/"+r.URL+"?searchid="+f)}})}catch(k){console.log(k.stack)}}function r(n,i){var r;try{tpc.waitToggle();var o="",s="",e=tpc.getGUID();$.ajax({type:"GET",async:!1,url:"/static/airports?q="+i.DealCriteria.Criteria.filter(function(n){return n.Key==="ORIGIN"})[0].Value,success:function(n){o=n.Items[0].Item},error:function(){}});$.ajax({type:"GET",async:!1,url:"/static/airports?q="+i.DealCriteria.Criteria.filter(function(n){return n.Key==="DESTINATION"})[0].Value,success:function(n){s=n.Items[0].Item},error:function(){}});tpc.airRequestObject.Flights.CabinCode=i.DealCriteria.Criteria.filter(function(n){return n.Key==="CLASS"})[0].Value;tpc.airRequestObject.Flights.TripType=i.DealCriteria.Criteria.filter(function(n){return n.Key==="TRIPTYPE"})[0].Value;tpc.airRequestObject.Flights.JourneyType="INT";tpc.airRequestObject.Passengers.Passenger[0].Count=i.DealCriteria.Criteria.filter(function(n){return n.Key==="ADT"})[0].Value;tpc.airRequestObject.Passengers.Passenger[1].Count=i.DealCriteria.Criteria.filter(function(n){return n.Key==="CHD"})[0].Value;tpc.airRequestObject.Passengers.Passenger[2].Count=i.DealCriteria.Criteria.filter(function(n){return n.Key==="INF"})[0].Value;tpc.airRequestObject.Flights.RequestedSegment=[];var u=new Date,f="",l=o.split("~")[0],h=o.split("~")[1],a=h.split("#")[1],v=s.split("~")[0],c=s.split("~")[1],y=c.split("#")[1];i.DealCriteria.Criteria.filter(function(n){return n.Key==="FLEXIDATE"})[0].Value==="true"?(f=u.setDate(u.getDate()+Number(i.DealCriteria.Criteria.filter(function(n){return n.Key==="FROMDATE"})[0].Value)),f=tpc.formatDate(f)):f=i.DealCriteria.Criteria.filter(function(n){return n.Key==="FROMDATE"})[0].Value;tpc.airRequestObject.Flights.RequestedSegment.push(new tpc.RequestedSegment(l,v,a,y,f,"",h,c));tpc.airRequestObject.Flights.TripType==="RT"&&(u=new Date,r="",i.DealCriteria.Criteria.filter(function(n){return n.Key==="FLEXIDATE"})[0].Value==="true"?(r=u.setDate(u.getDate()+Number(i.DealCriteria.Criteria.filter(function(n){return n.Key==="TODATE"})[0].Value)),r=tpc.formatDate(r)):r=i.DealCriteria.Criteria.filter(function(n){return n.Key==="TODATE"})[0].Value,tpc.airRequestObject.Flights.RequestedSegment.push(new tpc.RequestedSegment(v,l,y,a,r,"",c,h)));$.ajax({type:"POST",url:"/flight/search?searchid="+e,data:JSON.stringify({Root:tpc.airRequestObject}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){t(n,"/flightdeal/"+i.URL+"?searchid="+e)},failure:function(){t(n,"/flightdeal/"+i.URL+"?searchid="+e)},error:function(){t(n,"/flightdeal/"+i.URL+"?searchid="+e)}})}catch(p){console.log(p.stack)}}function t(n,t){$(n).attr("target")!==undefined&&$(n).attr("target")==="_blank"?window.open(t,"_blank"):window.location.href=t}return n.oneDay=864e5,n.dealList={},n.callAction=function(n){try{var f=$(n).attr("data-tp-deal-id"),u=tpcd.dealList.Response.DealList.Deal.filter(function(n){return n.Id===f})[0];u.SearchCriteria==="Y"?u.Product==="AIR"?r(n,u):u.Product==="HTL"&&i(n,u):t(n,"/deal/"+u.URL)}catch(e){return console.log(e.stacktrace),!1}},n}(tpcd||{});$(function(){$("[data-tp-deal-id]").click(function(){tpd.callAction(this)});$("[data-tp-section-content]").on("click","[data-tp-deal]",function(){tpcd.callAction(this)})})